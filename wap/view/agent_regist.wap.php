<?php defined('InShopNC') or exit('Access Invalid!');?>
<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta content="telephone=no" name="format-detection">
<meta name="format-detection" content="telephone=no">
<title>店铺注册</title>
<link rel="stylesheet" href="<?php echo IMG_CDN_URL;?>/v12/css/index.css<?php echo STATIC_VER;?>"/>
</head>
<body>
<div class="box-wrap">
<form>
    <section class="register-wrap">
        <div class="register-item" id="D_mobile">
            <div class="input-wrap">
                <input class="register-input" type="tel" id="mobile"  placeholder="请输入你的手机号"/>
            </div>

            <div class="register-yanzheng">
                <div class="input-wrap input-wrap2">
                    <input class="register-input" type="tel" id="smscode" placeholder="请输入验证码"/>
                </div>
                <button type="button" class="register-btn register-btn2" id="J_smscode" autofocus>获取验证码</button>
            </div>

            <div class="input-wrap">
                <input class="register-input" type="password" id="password" placeholder="请设置6-16位密码"/>
            </div>

            <div class="input-wrap">
                <input class="register-input" type="password" id="password2" placeholder="请重新输入一遍"/>
            </div>

            <p class="font-color-red">
                设置密码后，可以使用手机号+密码登录
            </p>

            <p>
                <button type="button" class="register-btn" id="J_next">下一步</button>
            </p>

            <p>
                <input type="checkbox" class="input-ck" id="J_agreed" checked/>
                阅读并同意<a href="javascript:void(0);" class="font-yellow" id="J_openterm" >服务协议</a>
            </p>
        </div>
        <div class="register-item" id="D_term" style="display:none">
            <h2>服务协议</h2>
              特别提示：<br>
在使用新玉麟电商代理平台之前，您应当认真阅读并遵守《新玉麟加盟代理服务协议》（以下简称“本协议”），请您务必审慎阅读、充分理解各条款内容。<br>
当您按照注册页面提示填写信息、阅读并同意本协议且完成全部注册程序后，或您以其他新玉麟允许的方式实际使用新玉麟电商代理平台时，即表示您已充分阅读、理解并接受本协议的全部内容，并与新玉麟达成协议。您承诺接受并遵守本协议的约定， 届时您不应以未阅读本协议的内容为由，主张本协议无效，或要求撤销本协议。<br>


一、 协议范围<br>
1、本协议由您与新玉麟电商代理平台的经营者共同缔结，本协议具有合同效力。<br>

2、新玉麟方有权根据需要不时地制订、修改本协议及/或各类规则，并以系统信息推送的方式进行变更公告，无需另行单独通知您。变更后的协议和规则一经公布后，立即或在公告明确的特定时间自动生效。若您在前述变更公告后继续使用平台，即表示您已经阅读、理解并接受经修订的协议和规则。若您不同意相关变更，应当立即停止使用平台。<br>

二、 注册与账户<br>

1、主体资格<br>

您确认，在您完成注册程序或以其他新玉麟允许的方式实际使用平台时，您应当是具备完全民事行为能权利能力和完全民事力的自然人、法人或其他组织。若您不具备前述主体资格，则您及您的监护人应承担因此而导致的一切后果，且平台有权注销或永久冻结您的账户，并向您及您的监护人索偿相应损失。<br>

2、注册和账户<br>

a）当您按照注册页面提示填写信息、阅读并同意本协议且完成全部注册程序后，或在您按照激活页面提示填写信息、阅读并同意本协议且完成全部激活程序后，或您以其他新玉麟允许的方式实际使用平台时，您即受本协议约束。您可以使用手机号码作为登录手段进入平台。<br>

b）在注册店铺时，您填写的姓名将作为店铺的名称（如注册姓名为王冰，注册成功后店铺的名称为“王冰的小店”），店铺名称注册后无法自行修改。您设置的店铺名称不得侵犯或涉嫌侵犯他人合法权益。如您设置的店铺名称涉嫌侵犯他人合法权益，新玉麟有权终止向您提供电商代理平台服务，注销您的店铺。<br>

3、用户信息<br>

在注册流程时，您应当依照法律法规要求，按相应页面的提示准确提供您的资料，并于资料信息变更时及时更新，以保证您所提交资料的真实、及时、完整和准确。如因个人填写资料错误、不实、过时或不完整的，由此产生的一系列后果由信息填写者个人承担，新玉麟对此不承担任何自认。 <br>


4、账户安全<br>

您须自行负责对您的登录名和密码保密， 如发现任何人未经授权使用您的店铺登录名和密码及支付宝登录名，或发生违反保密规定的任何其他情况，您会立即通知新玉麟。<br>

三、 新玉麟电商代理平台服务<br>

通过新玉麟提供的服务，用户可在新玉麟电商代理平台申请加盟代理其产品、拥有店铺、对店铺进行推广、与买家进行交流、达成交易意向并进行交易。<br>


四、新玉麟电商代理平台服务使用规范<br>

1、在使用新玉麟电商代理平台过程中，您承诺遵守以下约定：<br>

a)实施的所有行为均遵守国家法律、法规等规范性文件及新玉麟电商代理平台各项规则的规定和要求，不违背社会公共利益或公共道德，不损害他人的合法权益，不违反本协议及相关规则。<br>

b)在交易过程中，遵守诚实信用原则，不采取不正当竞争行为，不扰乱网上交易的正常秩序，不从事与新玉麟海参交易无关的行为。<br>


2、您了解并同意：<br>

a)基于维护平台交易秩序及交易安全的需要，新玉麟有权在发生恶意购买等扰乱市场正常交易秩序的情形下，执行关闭相应交易订单等操作。<br>

b)对于您在新玉麟电商代理平台上发布的涉嫌违法、涉嫌侵犯他人合法权利或违反本协议和/或规则的信息，新玉麟有权不经通知您即予以删除。<br>

c)如您涉嫌违反有关法律或者本协议之规定，使新玉麟遭受任何损失，或受到任何第三方的索赔，或受到任何行政管理部门的处罚，您应当赔偿微代因此造成的损失和/或发生的费用，包括合理的律师费用。<br>

六、责任范围和责任限制<br>

5、您了解并同意，新玉麟不对因下述任一情况而导致您的任何损害赔偿承担责任，包括但不限于利润、商誉、使用、数据等方面的损失或其它无形损失的损害赔偿 ：<br>

b)第三方未经批准的使用您的账户或更改您的数据。<br>

d)您对新玉麟电商代理平台服务的误解。<br>

e)任何非因新玉麟电商代理平台的原因而引起的与平台服务有关的其它损失。<br>

6、不论在何种情况下，新玉麟均不对由于信息网络正常的设备维护，信息网络连接故障，电脑、通讯或其他系统的故障，电力故障而造成的不能服务或延迟服务承担责任。<br>

七、协议终止<br>

您同意，新玉麟有权自行全权决定以任何理由不经事先通知的中止、终止向您提供新玉麟电商代理平台服务，暂时冻结或永久冻结（注销）您的账户在平台的权限，且无须为此向您或任何第三方承担任何责任。<br>
            <p>
                <button type="button" class="register-btn" id="J_closeterm">确定</button>
            </p>
        </div>
        <div class="register-item" id="D_regist" style="display:none">
            <div class="select-wrap register-select">
                <select class="select-draw-con" id="province_id" title="省" onchange="selectArea('city_id', this.options[this.selectedIndex].value)">
                    <option value="">-省-</option>
                </select>
                <div class="logo">
                    <span></span>
                </div>
            </div>
            <div class="select-wrap register-select">
                <select class="select-draw-con" id="city_id" title="市" onchange="selectArea('area_id', this.options[this.selectedIndex].value)">
                     <option value="">-市-</option>
                </select>
                <div class="logo">
                    <span></span>
                </div>
            </div>
            <div class="select-wrap register-select">
                <select class="select-draw-con"  id="area_id" title="区">
                    <option value="">-区-</option>
                </select>
                <div class="logo">
                    <span></span>
                </div>
            </div>
            <div class="input-wrap">
                <input class="register-input" type="text" id="truename"  placeholder="请输入您的真实姓名"/>
            </div>

            <div class="input-wrap">
                <input class="register-input" type="text" id="idcard"  placeholder="请输入您的身份证号"/>
            </div>

            <div class="input-wrap">
                <input class="register-input" type="text" id="idcard2"  placeholder="请重新输入您的身份证号"/>
            </div>

            <p class="font-color-red">
                请如实填写真实姓名和身份证号，否则将无法提现！
            </p>

            <p>
                <button type="button" class="register-btn" id="J_regist">确定提交</button>
            </p>
        </div>
    </section>
</form>
</div>
<script type="text/javascript" src="<?php echo IMG_CDN_URL;?>/v12/js/common.js<?php echo STATIC_VER;?>" charset="utf-8"></script>
<script type="text/javascript" src="<?php echo IMG_CDN_URL;?>/v12/js/zepto.min.js<?php echo STATIC_VER;?>" charset="utf-8"></script>
<script type="text/javascript" src="<?php echo IMG_CDN_URL;?>/v12/js/notification.js<?php echo STATIC_VER;?>" charset="utf-8"></script>
<script type="text/javascript" src="<?php echo IMG_CDN_URL;?>/v12/js/share/agent.js<?php echo STATIC_VER;?>" charset="utf-8"></script>
<script>
function disableItem(obj){
	$("#"+obj).prop("disabled", true).addClass("disabled");
}
function enableItem(obj, html){
	$("#"+obj).prop("disabled", false).removeClass("disabled");
}
/**
 *	发送短信验证码
 */
function sendSmsCode(phone){
	var regMobile=/^0?1(3|5|8)\d{9}$/;
	if(phone == ""){
		floatNotify.simple("手机号不能为空");
	}else if(!regMobile.test(phone)){
		floatNotify.simple("手机号格式错误");
	}else{
		//防止重发
		disableItem("J_smscode");

		$.post("?act=front&op=check_mobile", {mobile:phone}, function(result){
			var data = result.datas;
			if(data.exist){
				enableItem("J_smscode");
				floatNotify.simple("手机号已存在");
			}else{
				//发送短信号码
				$.post("?act=front&op=send_sms", {mobile:phone}, function(result){
					var data = result.datas;
					if(data.status){ //发送成功
						floatNotify.simple("发送成功请查收");
						disableItem("J_smscode");

						var seed  = 60, timer = setInterval(function(){
							seed --;
							$("#J_smscode").html(seed + "秒后重发");
							if(seed<=0){
								enableItem("J_smscode");
								$("#J_smscode").html("重获验证码");
								clearInterval(timer);
							}
						}, 1000);
					}else{
						enableItem("J_smscode");
						floatNotify.simple("发送失败请重试");
					}
				}, 'json');
			}
		},'json');
	}
}

/**
 *	校验提交表单
 */
function checkMobileForm(step, callbcak){

	//地区信息
	var areainfo = "", s, o = ['province_id', 'city_id', 'area_id'];
	$.each(o, function(i, item){
		s = document.getElementById(item);
		areainfo += " " + s.options[s.selectedIndex].text;
	});

	var post = {
		mobile      : $("#mobile").val(),
		smscode     : $("#smscode").val(),
		password    : $("#password").val(),
		password2	: $("#password2").val(),
		province_id : $("#province_id").val(),
		city_id     : $("#city_id").val(),
		area_id     : $("#area_id").val(),
		areainfo	: areainfo,
		truename    : $("#truename").val(),
		shopname    : $("#truename").val()+"的小店",
		idcard      : $("#idcard").val(),
		idcard2     : $("#idcard2").val()
	};
	var regMobile = /^0?1(3|5|8)\d{9}$/;
	var error     = '';

	if(step == 1){
		var btnObject = "J_next";
		if(post.mobile == ""){
			error = "手机号不能为空";
		}else if(!regMobile.test(post.mobile)){
			error = "手机号格式错误";
		}else if(post.smscode == ""){
			error = "验证码不能为空";
		}else if(post.password == ""){
			error = "密码不能为空";
		}else if(post.password.length <6 || post.password.length>16){
			error = "密码为6-16字符";
		}else if(post.password != post.password2){
			error = "两次密码不相同";
		}else{
			error = "";
		}
	}else{
		var btnObject = "J_regist";
		if(!(post.province_id && post.city_id && post.area_id)){
			error = "地区没有选择";
		}else if(post.truename == ""){
			error = "真实姓名不能为空";
		}else if(post.idcard == ""){
			error = "身份证不能为空";
		}else if(!(post.idcard.length == 15 || post.idcard.length == 18)){
			error = "身份证格式错误";
		}else if(post.idcard != post.idcard2){
			error = "两次输入不相同";
		}else{
			error = "";
		}
	}

	if(error){
		enableItem(btnObject);
		floatNotify.simple(error);
	}else{
		disableItem(btnObject);
		$.post("?act=front&op=agent_doregist&step="+step, post, function(result){
			var data = result.datas;
			if(data.error){
				enableItem(btnObject);
				floatNotify.simple(data.error);
			}else{
				disableItem(btnObject);
				callbcak(result);
			}
		}, 'json');
	}
}

/**
 *	获取区域数据
 */
function selectArea(obj_id, pid){
	$.get("?act=front&op=get_area&pid="+parseInt(pid), function(result){
		var list = result.datas, s='<option value="">-' +$("#"+obj_id).attr("title")+ '-</option>';
		for(i in list){
			s += '<option value="' +list[i].id+ '">' +list[i].name+ '</option>';
		}
		$("#"+obj_id).html(s);
	}, 'json');
}

$(function(){
	setTimeout(function(){
		$(".shuoming").css({'height':$(window).height()*0.55+'px','overflow-x':'hidden','overflow-y':'auto'});
	}, 300);//android延时

	$("#J_agreed").change(function(){
		if(this.checked){
			enableItem("J_next");
		}else{
			disableItem("J_next");
		}
	});

	$("#J_apply").on(touchMethod, function(e){
		 $("#D_mobile").show();
		 $("#D_regist").hide();
	});

	$("#J_next").on(touchMethod, function(e){
		 if(!$(this).hasClass("disabled")){
			 checkMobileForm(1, function(result){
				 $("#D_mobile").hide();
				 $("#D_regist").show();

				 selectArea("province_id", 0);
			 });
		 }
	});

	$("#J_regist").on(touchMethod, function(e){
		if(!$(this).hasClass("disabled")){
			checkMobileForm(2, function(result){
				floatNotify.simple("注册成功");

				var data = result.datas;
				addcookie("mb_user_token", data.key, 99999);
				addcookie("mb_user_agent", data.member_id, 99999);
				location.href="?act=agent";
			});
		}
	});

	$("#J_openterm").on(touchMethod, function(e){
		$("#D_mobile").hide();
		$("#D_term").show();
	});

	$("#J_closeterm").on(touchMethod, function(e){
		$("#D_mobile").show();
		$("#D_term").hide();
	});

	$("#J_smscode").on(touchMethod, function(e){
		if($(this).hasClass("disabled")){
			floatNotify.simple("验证码已发送，请稍后再试");
		}else{
			sendSmsCode($("#mobile").val());
		}
	});
});
</script>
<!-- 站长统计功能 -->
<script type="text/javascript">var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F921b4696aec0527b77e8a3edc6d65da1' type='text/javascript'%3E%3C/script%3E"));</script>
</body>
</html>